"use strict";(self["webpackChunkmy_cinima"]=self["webpackChunkmy_cinima"]||[]).push([[126],{5126:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticStyle:{"font-size":"20px","line-height":"30px"}},[t("i",{staticClass:"el-icon-user"}),e._v(" 会员列表")]),t("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary"},on:{click:e.handleRegister}},[e._v("会员注册")]),t("el-select",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"按生日查询"},model:{value:e.condition.birthdayQuery,callback:function(t){e.$set(e.condition,"birthdayQuery",t)},expression:"condition.birthdayQuery"}},[t("el-option",{key:"0",attrs:{label:"当天过生日",value:"1"}}),t("el-option",{key:"2",attrs:{label:"七天内过生日",value:"7"}}),t("el-option",{key:"3",attrs:{label:"十天内过生日",value:"10"}})],1),t("el-input",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"会员名称查询"},model:{value:e.condition.name,callback:function(t){e.$set(e.condition,"name",t)},expression:"condition.name"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")])],1),t("el-table",{staticClass:"table",attrs:{data:e.memberData,border:""}},[t("el-table-column",{attrs:{prop:"memberId",label:"ID",width:"180",align:"center"}}),t("el-table-column",{attrs:{prop:"grade",label:"等级",width:"180",align:"center"}}),t("el-table-column",{attrs:{prop:"integral",label:"积分",align:"center"}}),t("el-table-column",{attrs:{prop:"name",width:"150",label:"会员姓名",align:"center"}}),t("el-table-column",{attrs:{prop:"sex",label:"性别",align:"center"}}),t("el-table-column",{attrs:{prop:"birthday",label:"生日",align:"center"}}),t("el-table-column",{attrs:{label:"操作",width:"500",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-postcard"},on:{click:function(t){return e.exchangeClick(a.row)}}},[e._v("兑换商品")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-postcard"},on:{click:function(t){return e.checkClick(a.row)}}},[e._v("查看会员卡")]),t("el-button",{attrs:{type:"warning",icon:"el-icon-edit"},on:{click:function(t){return e.modifyClick(a.row)}}},[e._v("修改 ")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteClick(a.row)}}},[e._v("删除 ")])]}}])})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total, prev, pager, next","current-page":e.page.index,"page-size":e.page.size,total:e.page.total},on:{"current-change":e.handlePageChange}}),t("member-dialog",{ref:"register",attrs:{title:"注册",type:e.registerType}}),t("member-dialog",{ref:"check",attrs:{title:"确认会员信息",type:e.checkType}}),t("member-dialog",{ref:"modify",attrs:{title:"修改",type:e.modifyType}}),t("exchange-dialog",{ref:"exchange"})],1)],1)},i=[],s=a(8802),n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"40%"},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[e.memberId?t("el-form-item",{attrs:{label:"会员Id",prop:"memberId"}},[t("el-input",{attrs:{disabled:e.isDisabled},model:{value:e.form.memberId,callback:function(t){e.$set(e.form,"memberId",t)},expression:"form.memberId"}})],1):e._e(),e.name?t("el-form-item",{attrs:{label:"会员姓名",prop:"name"}},[t("el-input",{attrs:{disabled:e.isDisabled},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1):e._e(),e.password?t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{"show-password":"",placeholder:"请输入密码",disabled:e.isDisabled},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e(),e.sex?t("el-form-item",{attrs:{label:"性别",prop:"sex"}},[t("el-radio",{attrs:{label:"男",disabled:e.isDisabled},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("男")]),t("el-radio",{attrs:{label:"女",disabled:e.isDisabled},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("女")])],1):e._e(),e.birthday?t("el-form-item",{attrs:{label:"生日",prop:"birthday"}},[t("el-date-picker",{attrs:{disabled:e.isDisabled,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期",format:"yyyy-MM-dd"},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1):e._e()],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},l=[],o={props:["title","type"],data(){return{visible:!1,form:{},rules:{memberId:[{required:!0,message:"请输入会员名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],sex:[{required:!0,message:"请输入性别",trigger:"blur"}],birthday:[{required:!0,message:"请输入生日",trigger:"blur"}]}}},computed:{isDisabled:function(){return!!this.type.disabled&&this.type.disabled},memberId:function(){return this.isExist("memberId")},name:function(){return this.isExist("name")},password:function(){return this.isExist("password")},sex:function(){return this.isExist("sex")},birthday:function(){return this.isExist("birthday")}},methods:{confirm(){this.visible=!1,this.$emit("memberDialogConfirm",this.form)},show(e){this.form=e,this.visible=!0},isExist(e){return-1!=this.type.item.indexOf(e)}}},c=o,m=a(1001),d=(0,m.Z)(c,n,l,!1,null,null,null),u=d.exports,h=a(1185),p={components:{MemberDialog:u,ExchangeDialog:h.Z},data(){return{condition:{birthdayQuery:"",name:""},memberData:[],page:{index:1,size:5,total:0},checkType:{item:["memberId","name"],disabled:!0},modifyType:{item:["name","password","sex","birthday"]},registerType:{item:["name","password","sex","birthday"]}}},mounted(){this.$refs.register.$on("memberDialogConfirm",(e=>{(0,s.hs)(e).then((e=>{200==e.status?(this.$message.success("添加成功"),this.getMemberData()):this.$message.success("添加失败，服务端出现问题")}))})),this.$refs.modify.$on("memberDialogConfirm",(e=>{(0,s.Rf)(e).then((e=>{200==e.status?(this.$message.success("编辑成功"),this.getMemberData()):this.$message.success("编辑失败，服务端出现问题")}))})),this.$refs.exchange.$on("ExchangeDialogConfirm",(e=>{(0,s.Dd)(e).then((e=>{200==e.status?(this.$message.success("兑换成功"),this.getMemberData()):this.$message.success("兑换失败，服务端出现问题")}))}))},created(){this.getMemberData()},methods:{getMemberData(){(0,s.Gh)({pageIndex:this.page.index,pageSize:this.page.size}).then((e=>{this.memberData=e.data.list,this.page.total=e.data.pageTotal}))},handlePageChange(e){this.page.index=e,this.handleSearch()},checkClick(e){this.$refs.check.show(e)},modifyClick(e){this.$refs.modify.show(e)},handleRegister(){this.$refs.register.show({})},exchangeClick(e){this.$refs.exchange.show(e)},handleSearch(){(0,s.tb)({pageIndex:this.page.index,pageSize:this.page.size,name:this.condition.name,birthdayType:this.condition.birthdayQuery}).then((e=>{this.memberData=e.data.list,this.page.total=e.data.pageTotal}))},deleteClick(e){this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{(0,s.EP)(e).then((e=>{200==e.status?(this.$message.success("删除成功"),this.getMemberData()):this.$message.error("删除失败，服务器出现故障")}))})).catch((()=>{}))}}},b=p,g=(0,m.Z)(b,r,i,!1,null,null,null),f=g.exports},1185:function(e,t,a){a.d(t,{Z:function(){return m}});var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"消费",visible:e.visible,width:"70%"},on:{"update:visible":function(t){e.visible=t}}},[t("el-table",{attrs:{border:"",data:e.goodData},on:{"current-change":e.chooseGood}},[t("el-table-column",{attrs:{prop:"name",label:"商品名"}}),t("el-table-column",{attrs:{prop:"stock",label:"剩余"}}),t("el-table-column",{attrs:{prop:"integral",label:"积分"}})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total, prev, pager, next","current-page":e.page.index,"page-size":e.page.size,total:e.page.total},on:{"current-change":e.handlePageChange}}),t("el-form",{attrs:{"label-width":"70px",size:"mini"}},[t("el-form-item",{attrs:{label:"商品名"}},[e._v(" "+e._s(e.exchange.name)+" ")]),t("el-form-item",{attrs:{label:"数量"}},[t("el-input",{on:{change:e.inputNumber},model:{value:e.exchange.number,callback:function(t){e.$set(e.exchange,"number",t)},expression:"exchange.number"}})],1),t("el-form-item",{attrs:{label:"总积分"}},[e._v(" "+e._s(e.exchange.totalIntegral)+" ")])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},i=[],s=a(9109),n={data(){return{visible:!1,memberInfo:{},goodData:[],page:{index:1,size:4,total:0},exchange:{memberId:"",name:"",totalIntegral:0,number:0}}},created(){this.getGoodData()},methods:{confirm(){this.visible=!1,this.$emit("ExchangeDialogConfirm",this.exchange)},show(e){this.memberInfo=e,this.exchange.memberId=e.memberId,this.visible=!0},getGoodData(){(0,s.To)({pageIndex:this.page.index,pageSize:this.page.size}).then((e=>{this.goodData=e.data.list,this.page.total=e.data.pageTotal}))},handlePageChange(e){this.page.index=e,this.getGoodData()},chooseGood(e){let t=e;this.exchange.name=t.name,0===this.exchange.number&&(this.exchange.number=1),this.exchange.totalIntegral=t.integral*this.exchange.number}}},l=n,o=a(1001),c=(0,o.Z)(l,r,i,!1,null,null,null),m=c.exports},9109:function(e,t,a){a.d(t,{To:function(){return i},aH:function(){return l},bT:function(){return s},or:function(){return n}});var r=a(1117);const i=e=>(0,r.Z)({url:"selectAllGood",method:"get",params:e}),s=e=>(0,r.Z)({url:"addGood",method:"post",params:e}),n=e=>(0,r.Z)({url:"modifyGood",method:"post",params:e}),l=e=>(0,r.Z)({url:"deleteGood",method:"post",params:e})},8802:function(e,t,a){a.d(t,{Dd:function(){return o},EP:function(){return l},Gh:function(){return i},H_:function(){return m},Rf:function(){return n},dF:function(){return d},hs:function(){return s},tb:function(){return c}});var r=a(1117);const i=e=>(0,r.Z)({url:"selectAllMember",method:"get",params:e}),s=e=>(0,r.Z)({url:"registerMember",method:"post",params:e}),n=e=>(0,r.Z)({url:"modifyMember",method:"get",params:e}),l=e=>(0,r.Z)({url:"deleteMember",method:"get",params:e}),o=e=>(0,r.Z)({url:"exchange",method:"get",params:e}),c=e=>(0,r.Z)({url:"selectMemberByCondition",method:"get",params:e}),m=e=>(0,r.Z)({url:"getMemberAllInfo",method:"get",params:e}),d=e=>(0,r.Z)({url:"selectCardByMemberId",method:"get",params:e})}}]);
//# sourceMappingURL=126.e77770e6.js.map