"use strict";(self["webpackChunkmy_cinima"]=self["webpackChunkmy_cinima"]||[]).push([[611],{9611:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticStyle:{"font-size":"20px","line-height":"30px"}},[t("i",{staticClass:"el-icon-user"}),e._v(" 会员卡列表")]),t("el-input",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"会员ID查询"},model:{value:e.condition.memberId,callback:function(t){e.$set(e.condition,"memberId",t)},expression:"condition.memberId"}}),t("el-input",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"会员名称查询"},model:{value:e.condition.name,callback:function(t){e.$set(e.condition,"name",t)},expression:"condition.name"}}),t("el-input",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"cadId查询"},model:{value:e.condition.cardId,callback:function(t){e.$set(e.condition,"cardId",t)},expression:"condition.cardId"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")])],1),t("el-table",{staticClass:"table",attrs:{data:e.cardData,border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{prop:"cardId",label:"ID",width:"180",align:"center"}}),t("el-table-column",{attrs:{prop:"grade",label:"等级",width:"180",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"会员",align:"center"}}),t("el-table-column",{attrs:{prop:"balance",label:"余额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.balance))]}}])}),t("el-table-column",{attrs:{prop:"lose",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:0===a.row.lose?"success":"danger"}},[e._v(" "+e._s(0===a.row.lose?"正常":"挂失")+" ")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"500px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[0===a.row.lose?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleRecharge(a.row)}}},[e._v("充值")]):e._e(),0===a.row.lose?t("el-button",{attrs:{type:"primary",disabled:0==a.row.balance},on:{click:function(t){return e.handleConsume(a.row)}}},[e._v("消费")]):e._e(),0===a.row.lose?t("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.handleLose(a.row)}}},[e._v("挂失")]):e._e(),1===a.row.lose?t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleCancel(a.row)}}},[e._v("解挂")]):e._e(),1===a.row.lose?t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleReissue(a.row)}}},[e._v("补卡")]):e._e()]}}])})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total, prev, pager, next","current-page":e.page.index,"page-size":e.page.size,total:e.page.total},on:{"current-change":e.handlePageChange}}),t("consume-dialog",{ref:"consume"}),t("recharge-dialog",{ref:"recharge"})],1)],1)},r=[],o=a(4307),i=a(6639),s=a(5058),l={components:{ConsumeDialog:i.Z,RechargeDialog:s.Z},data(){return{cardData:[],page:{index:1,size:5,total:0},condition:{nameId:"",name:"",cardId:""}}},created(){this.getCardData()},mounted(){this.$refs.consume.$on("ConsumeDialogConfirm",(e=>{(0,o.F_)(e).then((e=>{200==e.status?(this.$message.success("挂失成功"),this.getCardData()):this.$message.error("挂失失败，服务器出现故障")}))})),this.$refs.recharge.$on("RechargeDialogConfirm",(e=>{(0,o.H3)(e).then((e=>{this.handleSearch()}))}))},methods:{getCardData(){(0,o.sz)({pageIndex:this.page.index,pageSize:this.page.size}).then((e=>{this.cardData=e.data.list,this.page.total=e.data.pageTotal}))},handlePageChange(e){this.page.index=e,this.handleSearch()},handleSearch(){(0,o.AN)({pageIndex:this.page.index,pageSize:this.page.size,memberId:this.condition.memberId,name:this.condition.name,cardId:this.condition.cardId}).then((e=>{this.cardData=e.data.list,this.page.total=e.data.pageTotal}))},handleRecharge(e){this.$refs.recharge.show(e)},handleConsume(e){this.$refs.consume.show(e)},handleLose(e){this.$confirm("确定要挂失吗？","提示",{type:"warning"}).then((()=>{(0,o.TA)(e).then((e=>{200==e.status?(this.$message.success("挂失成功"),this.getCardData()):this.$message.error("挂失失败，服务器出现故障")}))})).catch((()=>{}))},handleCancel(e){this.$confirm("确定要解挂吗？","提示",{type:"warning"}).then((()=>{(0,o.NN)(e).then((e=>{200==e.status?(this.$message.success("解挂成功"),this.getCardData()):this.$message.error("解挂失败，服务器出现故障")}))})).catch((()=>{}))},handleReissue(e){this.$confirm("确定要补卡吗？","提示",{type:"warning"}).then((()=>{console.log(index),console.log(e)})).catch((()=>{}))}}},c=l,u=a(1001),d=(0,u.Z)(c,n,r,!1,null,null,null),m=d.exports},6639:function(e,t,a){a.d(t,{Z:function(){return u}});var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"消费",visible:e.visible,width:"70%"},on:{"update:visible":function(t){e.visible=t}}},[t("el-table",{attrs:{border:"",data:e.movieData},on:{"current-change":e.chooseMovie}},[t("el-table-column",{attrs:{prop:"name",label:"电影名"}}),t("el-table-column",{attrs:{prop:"price",label:"价格"}}),t("el-table-column",{attrs:{prop:"integral",label:"积分"}})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total, prev, pager, next","current-page":e.page.index,"page-size":e.page.size,total:e.page.total},on:{"current-change":e.handlePageChange}}),t("el-form",{attrs:{model:e.form,"label-width":"70px",size:"mini"}},[t("el-form-item",{attrs:{label:"电影名字"}},[e._v(" "+e._s(e.consume.name)+" ")]),t("el-form-item",{attrs:{label:"数量"}},[t("el-input",{on:{change:e.inputNumber},model:{value:e.consume.number,callback:function(t){e.$set(e.consume,"number",t)},expression:"consume.number"}})],1),t("el-form-item",{attrs:{label:"价格"}},[e._v(" "+e._s(e.consume.totalPrice)+" ")]),t("el-form-item",{attrs:{label:"获得积分"}},[e._v(" "+e._s(e.consume.totalIntegral)+" ")])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},r=[],o=a(555),i={data(){return{visible:!1,cardInfo:{},movieData:[],page:{index:1,size:4,total:0},consume:{cardId:"",name:"",totalPrice:0,totalIntegral:0,number:0}}},created(){this.getMovieData()},methods:{confirm(){this.visible=!1,this.$emit("ConsumeDialogConfirm",this.consume)},show(e){this.cardInfo=e,this.consume.cardId=e.cardId,this.visible=!0},getMovieData(){(0,o.zS)({pageIndex:this.page.index,pageSize:this.page.size}).then((e=>{this.movieData=e.data.list,this.page.total=e.data.pageTotal}))},handlePageChange(e){this.page.index=e,this.getMovieData()},chooseMovie(e){let t=e;this.consume.name=t.name,0===this.consume.number&&(this.consume.number=1),this.consume.totalPrice=t.price*this.consume.number,this.consume.totalIntegral=t.integral*this.consume.number},inputNumber(){this.consume.totalPrice=movie.price*this.consume.number,this.consume.totalIntegral=movie.integral*this.consume.number}}},s=i,l=a(1001),c=(0,l.Z)(s,n,r,!1,null,null,null),u=c.exports},5058:function(e,t,a){a.d(t,{Z:function(){return c}});var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"消费",visible:e.visible,width:"70%"},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{attrs:{model:e.form,"label-width":"70px",size:"mini"}},[t("el-form-item",{attrs:{label:"cardId"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.recharge.cardId,callback:function(t){e.$set(e.recharge,"cardId",t)},expression:"recharge.cardId"}})],1),t("el-form-item",{attrs:{label:"额度"}},[t("el-input",{model:{value:e.recharge.number,callback:function(t){e.$set(e.recharge,"number",t)},expression:"recharge.number"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},r=[],o={data(){return{visible:!1,cardInfo:{},recharge:{cardId:"",number:0}}},methods:{confirm(){this.visible=!1,this.$emit("RechargeDialogConfirm",this.recharge)},show(e){this.cardInfo=e,this.recharge.cardId=e.cardId,this.visible=!0}}},i=o,s=a(1001),l=(0,s.Z)(i,n,r,!1,null,null,null),c=l.exports},4307:function(e,t,a){a.d(t,{AN:function(){return o},F_:function(){return d},H3:function(){return u},L5:function(){return s},NN:function(){return c},TA:function(){return l},U$:function(){return i},sz:function(){return r}});var n=a(1117);const r=e=>(0,n.Z)({url:"selectAllCard",method:"post",params:e}),o=e=>(0,n.Z)({url:"selectCardByCondition",method:"post",params:e}),i=e=>(0,n.Z)({url:"selectAllConsumeRecord",method:"post",params:e}),s=e=>(0,n.Z)({url:"selectAllExchangeRecord",method:"post",params:e}),l=e=>(0,n.Z)({url:"cardLose",method:"post",params:e}),c=e=>(0,n.Z)({url:"cardCancel",method:"post",params:e}),u=e=>(0,n.Z)({url:"recharge",method:"post",params:e}),d=e=>(0,n.Z)({url:"consume",method:"post",params:e})},555:function(e,t,a){a.d(t,{DG:function(){return s},LZ:function(){return c},_m:function(){return i},dO:function(){return l},fx:function(){return u},g2:function(){return r},zS:function(){return o}});var n=a(1117);const r=e=>(0,n.Z)({url:"selectManagerByManagerId",method:"get",params:e}),o=e=>(0,n.Z)({url:"selectAllMovie",method:"get",params:e}),i=e=>(0,n.Z)({url:"getDealData",method:"get",params:e}),s=e=>(0,n.Z)({url:"getStatisticData",method:"get",params:e}),l=e=>(0,n.Z)({url:"addMovie",method:"get",params:e}),c=e=>(0,n.Z)({url:"modifyMovie",method:"get",params:e}),u=e=>(0,n.Z)({url:"deleteMovie",method:"get",params:e})}}]);
//# sourceMappingURL=611.b8f4aa6a.js.map